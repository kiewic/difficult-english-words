const https = require('https');
const fs = require('fs');
const puppeteer = require('puppeteer');
const _ = require('lodash');

const words = [{
  "text": "Brochure",
  "audio": "brochure.mp3",
  "pronunciation": "/ËˆbrÉ™ÊŠÊƒÉ™/"
}, {
  "text": "Origin",
  "audio": "origin.mp3",
  "pronunciation": "/ËˆorÉ™Ê¤É™n/"
}, {
  "text": "Incognito",
  "audio": "incognito.mp3",
  "pronunciation": "/ËŒÉªnËŒkÉ‘ËgËˆniËtoÊŠ/"
}, {
  "text": "Chaos",
  "audio": "chaos.mp3",
  "pronunciation": "/ËˆkeÉªËŒÉ‘Ës/"
}, {
  "text": "Debut",
  "audio": "debut.mp3",
  "pronunciation": "/ËˆdeÉªËŒbjuË/"
}, {
  "text": "Dubious",
  "audio": "dubious.mp3",
  "pronunciation": "/ËˆdjuËbijÉ™s/"
}, {
  "text": "Carbohydrate",
  "audio": "carbohydrate.mp3",
  "pronunciation": "/ËŒkÉ‘ÉšboÊŠËˆhaÉªËŒdreÉªt/"
}, {
  "text": "Vital",
  "audio": "vital.mp3",
  "pronunciation": "/ËˆvaÉªtlÌŸ/"
}, {
  "text": "Abide",
  "audio": "abide.mp3",
  "pronunciation": "/É™ËˆbaÉªd/"
}, {
  "text": "Entrepreneur",
  "audio": "entrepreneur.mp3",
  "pronunciation": "/ËŒÉ‘ËntrÉ™prÉ™ËˆnÉš/"
}, {
  "text": "Representative",
  "audio": "representative.mp3",
  "pronunciation": "/ËŒrÉ›prÉªËˆzÉ›ntÉ™tÉªv/"
}, {
  "text": "Pliers",
  "audio": "pliers.mp3",
  "pronunciation": "/ËˆplajÉšz/"
}, {
  "text": "Pear",
  "audio": "pear.mp3",
  "pronunciation": "/ËˆpeÉš/"
}, {
  "text": "Route",
  "audio": "route.mp3",
  "pronunciation": "/ËˆruËt/ /ËˆraÊŠt/"
}, {
  "text": "Determine",
  "audio": "determine.mp3",
  "pronunciation": "/dÉªËˆtÉšmÉ™n/"
}, {
  "text": "Determined",
  "audio": "determined.mp3",
  "pronunciation": "/dÉªËˆtÉšmÉªnd/"
}, {
  "text": "Undermine",
  "audio": "undermine.mp3",
  "pronunciation": "/ËŒÊŒndÉšËˆmaÉªn/"
}, {
  "text": "Maintain",
  "audio": "maintain.mp3",
  "pronunciation": "/meÉªnËˆteÉªn/"
}, {
  "text": "Jewel",
  "title": "JOOL",
  "audio": "jewel.mp3",
  "pronunciation": "/ËˆÊ¤uËl/"
}, {
  "text": "Jewelry",
  "title": "JOOL-ree",
  "audio": "jewelry.mp3"
}, {
  "text": "Variety",
  "audio": "variety.mp3",
  "pronunciation": "/vÉ™ËˆrajÉ™ti/"
}, {
  "text": "Occur",
  "audio": "occur.mp3",
  "pronunciation": "/É™ËˆkÉš/"
}, {
  "text": "Occurrences",
  "audio": "occurrences.mp3",
  "pronunciation": "/É™ËˆkÉšrÉ™ns/"
}, {
  "text": "Spouse",
  "audio": "spouse.mp3",
  "pronunciation": "/ËˆspaÊŠs/"
}, {
  "text": "Genre",
  "audio": "genre.mp3",
  "pronunciation": "/ËˆÊ’É‘ËnrÉ™/"
}, {
  "text": "Gender",
  "audio": "gender.mp3",
  "pronunciation": "/ËˆÊ¤É›ndÉš/"
}, {
  "text": "Evenly",
  "audio": "evenly.mp3",
  "pronunciation": "/ËˆiËvÉ™n/"
}, {
  "text": "Vocabulary",
  "audio": "vocabulary.mp3",
  "pronunciation": "/vÉ™ÊŠËˆkÃ¦bjÉ™lÉ™ri/"
}, {
  "text": "Capability",
  "audio": "capability.mp3",
  "pronunciation": "/ËŒkeÉªpÉ™ËˆbÉªlÉ™ti/"
}, {
  "text": "Awareness",
  "audio": "awareness.mp3",
  "pronunciation": "/ËŒsÉ›lfÉ™ËˆweÉšnÉ™s/"
}, {
  "text": "Theatre",
  "audio": "theatre.mp3"
}, {
  "text": "Aluminum",
  "audio": "aluminum.mp3",
  "pronunciation": "/É™ËˆluËmÉ™nÉ™m/"
}, {
  "text": "Drool ðŸ¤¤",
  "audio": "drool.mp3",
  "pronunciation": "/ËˆdruËl/"
}, {
  "text": "Thaw",
  "audio": "thaw.mp3",
  "pronunciation": "/ËˆÎ¸É‘Ë/"
}, {
  "text": "Couch",
  "audio": "couch.mp3",
  "pronunciation": "/ËˆkaÊŠtÊƒ/"
}, {
  "text": "Coach",
  "audio": "coach.mp3",
  "pronunciation": "/ËˆkoÊŠtÊƒ/"
}, {
  "text": "Yeast",
  "audio": "yeast.mp3",
  "pronunciation": "/ËˆjiËst/"
}, {
  "text": "Wheat",
  "audio": "wheat.mp3",
  "pronunciation": "/ËˆwiËt/"
}, {
  "text": "Theory",
  "title": "THEE-ree",
  "audio": "theory.mp3",
  "pronunciation": "/ËˆÎ¸iËjÉ™ri/"
}, {
  "text": "Vary",
  "audio": "vary.mp3",
  "pronunciation": "/Ëˆveri/"
}, {
  "text": "Very",
  "audio": "very.mp3",
  "pronunciation": "/Ëˆveri/"
}, {
  "text": "Annual",
  "audio": "annual.mp3",
  "pronunciation": "/ËˆÃ¦njÉ™wÉ™l/"
}, {
  "text": "Negate",
  "audio": "negate.mp3",
  "pronunciation": "/nÉªËˆgeÉªt/"
}, {
  "text": "Apparent",
  "audio": "apparent.mp3",
  "pronunciation": "/É™ËˆperÉ™nt/"
}, {
  "text": "Alternately",
  "audio": "alternately.mp3",
  "pronunciation": "/ËˆÉ‘ËltÉšËŒneÉªt/"
}, {
  "text": "Perishable",
  "audio": "perishable.mp3",
  "pronunciation": "/ËˆperÉªÊƒÉ™bÉ™l/"
}, {
  "text": "Actively",
  "audio": "actively.mp3",
  "pronunciation": "/ËˆÃ¦ktÉªv/"
}, {
  "text": "Stabilize",
  "audio": "stabilize.mp3"
}, {
  "text": "Minor",
  "audio": "minor.mp3",
  "pronunciation": "/ËˆmaÉªnÉš/"
}, {
  "text": "Gorgeous",
  "audio": "gorgeous.mp3",
  "pronunciation": "/ËˆgoÉšÊ¤É™s/"
}, {
  "text": "Figuratively",
  "audio": "figuratively.mp3",
  "pronunciation": "/ËˆfÉªgjÉ™rÉ™tÉªvli/"
}, {
  "text": "Chandelier",
  "audio": "chandelier.mp3",
  "pronunciation": "/ËŒÊƒÃ¦ndÉ™ËˆliÉš/"
}, {
  "text": "Interest",
  "title": "IN-trest",
  "audio": "interest.mp3",
  "pronunciation": "/ËˆÉªntrÉ™st/"
}, {
  "text": "Interesting",
  "title": "IN-trest-ing",
  "audio": "interesting.mp3",
  "pronunciation": "/ËˆÉªntrÉ™stÉªÅ‹/"
}, {
  "text": "Ivory",
  "title": "IVE-ree",
  "audio": "ivory.mp3",
  "pronunciation": "/ËˆaÉªvÉ™ri/"
}, {
  "text": "Laboratory",
  "title": "LAB-ruh-tory",
  "audio": "laboratory.mp3",
  "pronunciation": "/lÉ™ËˆbÉ’rÉ™tri/"
}, {
  "text": "Miniature",
  "title": "MIN-uh-cher",
  "audio": "miniature.mp3",
  "pronunciation": "/ËˆmÉªnijÉ™ËŒtÊƒuÉš/"
}, {
  "text": "Miserable",
  "title": "MIZ-ruh-bul",
  "audio": "miserable.mp3",
  "pronunciation": "/ËˆmÉªzÉ™rÉ™bÉ™l/"
}, {
  "text": "Mystery",
  "title": "MIST-ree",
  "audio": "mystery.mp3",
  "pronunciation": "/ËˆmÉªstÉ™ri/"
}, {
  "text": "Opera",
  "title": "AHP-ruh",
  "audio": "opera.mp3",
  "pronunciation": "/ËˆÉ‘ËpÉ™rÉ™/"
}, {
  "text": "Practically",
  "title": "PRAK-tik-lee",
  "audio": "practically.mp3",
  "pronunciation": "/ËˆprÃ¦ktÉªkli/"
}, {
  "text": "Preference",
  "title": "PREF-rence",
  "audio": "preference.mp3",
  "pronunciation": "/ËˆprÉ›frÉ™ns/"
}, {
  "text": "Respiratory",
  "title": "RES-pri=tor-ee",
  "audio": "respiratory.mp3",
  "pronunciation": "/rÉªËˆspÉªrÉ™tri/"
}, {
  "text": "Reverence",
  "title": "REV-rence",
  "audio": "reverence.mp3",
  "pronunciation": "/ËˆrÉ›vÉ™rÉ™ns/"
}, {
  "text": "Separate",
  "title": "SEP-ret",
  "audio": "separate.mp3",
  "pronunciation": "/ËˆsÉ›pÉ™rÉ™t/"
}, {
  "text": "Separately",
  "title": "SEP-ret-lee",
  "audio": "separately.mp3",
  "pronunciation": "/ËˆsÉ›pÉ™rÉ™tli/"
}, {
  "text": "Several",
  "title": "SEV-rul",
  "audio": "several.mp3",
  "pronunciation": "/ËˆsÉ›vÉ™rÉ™l/"
}, {
  "text": "Sophomore",
  "title": "SAWF-more",
  "audio": "sophomore.mp3",
  "pronunciation": "/ËˆsÉ‘ËfËŒmoÉš/"
}, {
  "text": "Temperature",
  "title": "TEMP-ruh-tcher",
  "audio": "temperature.mp3",
  "pronunciation": "/ËˆtÉ›mprÉ™ËŒtÊƒuÉš/"
}, {
  "text": "Toward",
  "title": "TORD",
  "audio": "toward.mp3",
  "pronunciation": "/ËˆtowÉšd/ /ËˆtoÉšd/"
}, {
  "text": "Traveling",
  "title": "TRAV-ling",
  "audio": "traveling.mp3"
}, {
  "text": "Vegetable",
  "title": "VEJ-tuh-bul",
  "audio": "vegetable.mp3",
  "pronunciation": "/ËˆvÉ›Ê¤tÉ™bÉ™l/"
}, {
  "text": "Veterinarian",
  "title": "vet-ru-NAR-ee-un",
  "audio": "veterinarian.mp3",
  "pronunciation": "/ËŒvÉ›tÉ™rÉ™ËˆnerijÉ™n/"
}, {
  "text": "Virtually",
  "title": "VER-chuh-lee",
  "audio": "virtually.mp3",
  "pronunciation": "/ËˆvÉštÊƒÉ™wÉ™li/"
}, {
  "text": "Wednesday",
  "title": "WENS-day",
  "audio": "wednesday.mp3",
  "pronunciation": "/ËˆwÉ›nzËŒdeÉª/"
}, {
  "text": "Accidentally",
  "title": "aks-ih-DENT-lee",
  "audio": "accidentally.mp3",
  "pronunciation": "/ËŒÃ¦ksÉ™ËˆdÉ›ntlÌŸ/"
}, {
  "text": "Actually",
  "title": "AK-shul-ee",
  "audio": "actually.mp3",
  "pronunciation": "/ËˆÃ¦ktÊƒÉ™wÉ™li/"
}, {
  "text": "Aspirin",
  "title": "ASS-prin",
  "audio": "aspirin.mp3",
  "pronunciation": "/ËˆÃ¦spÉ™rÉ™n/"
}, {
  "text": "Average",
  "title": "AV-rej",
  "audio": "average.mp3",
  "pronunciation": "/ËˆÃ¦vrÉªÊ¤/"
}, {
  "text": "Basically",
  "title": "BASE-ik-ly",
  "audio": "basically.mp3",
  "pronunciation": "/ËˆbeÉªsÉªkli/"
}, {
  "text": "Beverage",
  "title": "BEV-rej",
  "audio": "beverage.mp3",
  "pronunciation": "/ËˆbÉ›vrÉªÊ¤/"
}, {
  "text": "Broccoli",
  "title": "BROK-lee",
  "audio": "broccoli.mp3",
  "pronunciation": "/ËˆbrÉ‘ËkÉ™li/"
}, {
  "text": "Business",
  "title": "BIZ-nuss",
  "audio": "business.mp3"
}, {
  "text": "Camera",
  "title": "KAM-ruh",
  "audio": "camera.mp3",
  "pronunciation": "/ËˆkÃ¦mrÉ™/"
}, {
  "text": "Catholic",
  "title": "KATH-lik",
  "audio": "catholic.mp3",
  "pronunciation": "/ËˆkÃ¦Î¸lÉªk/"
}, {
  "text": "Chocolate",
  "title": "CHOK-let",
  "audio": "chocolate.mp3",
  "pronunciation": "/ËˆtÊƒÉ‘ËklÉ™t/"
}, {
  "text": "Comfortable",
  "title": "KOMF-ter-bul",
  "audio": "comfortable.mp3",
  "pronunciation": "/ËˆkÊŒmftÉšbÉ™l/"
}, {
  "text": "Deliberately",
  "title": "duh-LIB-rut-lee",
  "audio": "deliberately.mp3",
  "pronunciation": "/dÉªËˆlÉªbÉ™rÉ™tli/"
}, {
  "text": "Desperate",
  "title": "DESS-pret",
  "audio": "desperate.mp3",
  "pronunciation": "/ËˆdÉ›sprÉ™t/"
}, {
  "text": "Diamond",
  "title": "DIE-mund",
  "audio": "diamond.mp3",
  "pronunciation": "/ËˆdaÉªmÉ™nd/"
}, {
  "text": "Diaper",
  "title": "DIE-per",
  "audio": "diaper.mp3",
  "pronunciation": "/ËˆdaÉªpÉš/"
}, {
  "text": "Difference",
  "title": "DIF-rence",
  "audio": "difference.mp3",
  "pronunciation": "/ËˆdÉªfrÉ™ns/"
}, {
  "text": "Different",
  "title": "DIF-rent",
  "audio": "different.mp3",
  "pronunciation": "/ËˆdÉªfrÉ™nt/"
}, {
  "text": "Discovery",
  "title": "dis-KUV-ree",
  "audio": "discovery.mp3",
  "pronunciation": "/dÉªËˆskÊŒvÉ™ri/"
}, {
  "text": "Elementary",
  "title": "el-uh-MEN-tree",
  "audio": "elementary.mp3",
  "pronunciation": "/ËŒÉ›lÉ™ËˆmÉ›ntri/"
}, {
  "text": "Evening",
  "title": "EEV-ning",
  "audio": "evening.mp3",
  "pronunciation": "/ËˆiËvnÉªÅ‹/"
}, {
  "text": "Every",
  "title": "EHV-ree",
  "audio": "every.mp3",
  "pronunciation": "/ËˆÉ›vri/"
}, {
  "text": "Extraordinary",
  "title": "ex-TROT-din-ary",
  "audio": "extraordinary.mp3"
}, {
  "text": "Family",
  "title": "FAM-lee",
  "audio": "family.mp3",
  "pronunciation": "/ËˆfÃ¦mli/"
}, {
  "text": "Favorite",
  "title": "FAV-rit",
  "audio": "favorite.mp3"
}, {
  "text": "Federal",
  "title": "FED-rul",
  "audio": "federal.mp3",
  "pronunciation": "/ËˆfÉ›dÉ™rÉ™l/"
}, {
  "text": "General",
  "title": "JEN-ruhl",
  "audio": "general.mp3",
  "pronunciation": "/ËˆÊ¤É›nrÉ™l/"
}, {
  "text": "Generally",
  "title": "JEN-ruh-lee",
  "audio": "generally.mp3",
  "pronunciation": "/ËˆÊ¤É›nrÉ™li/"
}, {
  "text": "Calvary",
  "audio": "calvary.mp3",
  "pronunciation": "/ËˆkÃ¦lvÉ™ri/"
}, {
  "text": "Colonel",
  "audio": "colonel.mp3",
  "pronunciation": "/ËˆkÉšnlÌŸ/"
}, {
  "text": "February",
  "audio": "february.mp3",
  "pronunciation": "/ËˆfÉ›bjÉ™ËŒweri/ /ËˆfÉ›brÉ™ËŒweri/"
}, {
  "text": "Hurricane",
  "audio": "hurricane.mp3",
  "pronunciation": "/ËˆhÊŒrÉ™kÉ™n/"
}, {
  "text": "Creaking",
  "audio": "creaking.mp3",
  "pronunciation": "/ËˆkriËk/"
}];

(async () => {
  const browser = await puppeteer.launch();

  for (const word of words) {
    try {
      if (word.pronunciation) {
        continue;
      }

      const page = await browser.newPage();
      const url = `https://www.learnersdictionary.com/definition/${encodeURIComponent(word.text)}`;
      console.log(url);
      await page.goto(url);

      let pronunciations = await page.evaluate(() => {
        // Note 1: here you can use querySelectorAll()
        // Note 2: eval can't return non-serializable data, so, you need to JSON.stringify() to receive objects.
        const element = document.querySelector('.text_prons');
        return element.innerText;
      });
      pronunciations = pronunciations
        .replace(/\s+/g, ' ')
        .replace(/.+Brit/g, ' ')
        .trim();
      console.log(pronunciations);

      word.pronunciation = pronunciations;

      // await page.screenshot({ path: 'example.png' });
    }
    catch (error) {
      console.log(`Error downloading ${word.text}`);
      console.error(error);
    }
  }

  await browser.close();

  console.log(JSON.stringify(words));
})();
